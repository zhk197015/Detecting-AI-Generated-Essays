# **Strong Baseline Classifier - GLTR**

The `strong-baseline-gltr.py` script implements a stronger baseline classifier for detecting AI-generated essays. 
This baseline uses a GPT-2-based GLTR-like analysis to predict whether a text is machine-generated or human-written.

## **How to Use the Script**

### **Prerequisites**

- Python 3.x installed on your system.
- Required Python packages: `torch`, `transformers`, `pandas`, `argparse`, `sklearn.metrics`.

### **Script Overview**

#### **Input Arguments:**
- `--dev`: Path to the development CSV file.
- `--test`: Path to the test CSV file.
- `--output`: Path to save the output predictions CSV file.

#### **Functionality:**

1. Loads the development test data containing the texts to be analyzed.
2. Performs GLTR-like analysis using GPT-2:
   - Tokenizes the input text.
   - Calculates probabilities of each token being generated by GPT-2.
   - Classifies a token as having a high probability of being AI-generated if its probability exceeds 0.5.
   - Calculates proportions of high-probability tokens in the input text.
   - Tune the threshold on development data for the proportion of high-probability tokens in the input text to classify it as AI-generated.
   - Predicts the likelihood of the text being machine-generated based on the best threshold.
3. Saves predictions to the specified output file.

### **Running the Script**

#### **1. Navigate to the Project Directory**

Open a terminal and navigate to the directory containing the `strong-baseline-gltr.py` script.

#### **2. Run the Script with Required Arguments**

```bash
python strong-baseline-gltr.py --dev <path_to_dev.csv> --test <path_to_test.csv> --output <path_to_output_predictions.csv>
```
   **Example:**

   ```bash
   python strong-baseline-gltr.py --dev data/dev_data.csv --test data/test_data.csv --output output/predictions/strong_baseline_gltr_predictions.csv
   ```

   - **Explanation:**
     - `data/dev_data.csv`: The development dataset for which threshold is to be tuned.
     - `data/test_data.csv`: The test dataset for which predictions are to be made.
     - `output/predictions/strong_baseline_gltr_predictions`: The file where predictions will be saved.

3. **Sample Output:**

   ```
   Testing threshold 0.2
   F1 score is 0.7651607651607651
   Best threshold: 0.2, Best F1 score: 0.7651607651607651
   Results saved to output/predictions/strong_baseline_gltr_predictions.csv
   ```
